<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Conflict Resolution UI Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      .gradient-bg {
        background: linear-gradient(135deg, #f59e0b 0%, #dc2626 100%);
      }
    </style>
  </head>
  <body class="bg-gray-100 p-8">
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      // Mock conflict data
      const mockConflictData = {
        status: "conflict",
        message: "The requested time slot conflicts with existing meetings",
        original_request: {
          start: "2024-12-15 14:00",
          end: "2024-12-15 15:00",
          start_formatted: "Sunday, December 15 at 02:00 PM",
        },
        suggestions: [
          {
            option: 1,
            start: "2024-12-15 16:45",
            end: "2024-12-15 17:45",
            start_formatted: "Sunday, December 15 at 04:45 PM",
            description: "Next available time slot",
            strategy: "next_available",
          },
          {
            option: 2,
            start: "2024-12-15 09:00",
            end: "2024-12-15 10:00",
            start_formatted: "Sunday, December 15 at 09:00 AM",
            description: "Earlier the same day",
            strategy: "earlier_same_day",
          },
          {
            option: 3,
            start: "2024-12-16 14:00",
            end: "2024-12-16 15:00",
            start_formatted: "Monday, December 16 at 02:00 PM",
            description: "Same time tomorrow",
            strategy: "next_day_same_time",
          },
        ],
        timezone: "UTC",
      };

      function ConflictResolutionTest() {
        const [isAwaitingConflictResolution, setIsAwaitingConflictResolution] =
          useState(true);
        const [conflictData, setConflictData] = useState(mockConflictData);
        const [messages, setMessages] = useState([]);

        const addMessage = (message) => {
          const timestamp = new Date().toLocaleTimeString();
          setMessages((prev) => [...prev, `${timestamp}: ${message}`]);
        };

        const handleOptionSelect = (option) => {
          addMessage(`üë§ Selected: Option ${option}`);
          alert(
            `Selected Option ${option}: ${
              conflictData.suggestions[option - 1].start_formatted
            }`
          );
        };

        const handleDifferentTimes = () => {
          addMessage(`üë§ You said: "I want different times"`);
          alert("Requesting different options");
        };

        const handleCancel = () => {
          setIsAwaitingConflictResolution(false);
          setConflictData(null);
          addMessage(`üë§ Cancelled conflict resolution`);
        };

        return (
          <div className="max-w-4xl mx-auto space-y-6">
            <h1 className="text-3xl font-bold text-center text-gray-800 mb-8">
              üöÄ Conflict Resolution UI Test
            </h1>

            {/* Conflict Resolution Panel */}
            {isAwaitingConflictResolution && conflictData && (
              <div className="border-0 shadow-xl bg-gradient-to-r from-orange-50 to-red-50 backdrop-blur-sm border-orange-200 rounded-lg">
                <div className="p-6 border-b border-orange-200">
                  <h2 className="text-lg font-semibold text-orange-800 flex items-center gap-2 mb-2">
                    ‚ö†Ô∏è Scheduling Conflict Detected
                  </h2>
                  <p className="text-orange-700">
                    Your requested time conflicts with existing meetings. Please
                    choose an alternative:
                  </p>
                </div>
                <div className="p-6 space-y-4">
                  <div className="p-3 bg-orange-100 rounded-lg border border-orange-200">
                    <p className="text-sm font-medium text-orange-800">
                      Original Request:
                    </p>
                    <p className="text-orange-700">
                      {conflictData.original_request.start_formatted}
                    </p>
                  </div>

                  <div className="space-y-3">
                    <p className="text-sm font-medium text-orange-800">
                      Alternative Options:
                    </p>
                    {conflictData.suggestions.map((suggestion) => (
                      <div
                        key={suggestion.option}
                        className="p-4 bg-white rounded-lg border border-orange-200 hover:border-orange-300 transition-colors cursor-pointer hover:shadow-md"
                        onClick={() => handleOptionSelect(suggestion.option)}
                      >
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-1">
                              <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 border border-orange-300">
                                Option {suggestion.option}
                              </span>
                              <span className="text-xs text-gray-500 uppercase tracking-wide">
                                {suggestion.strategy.replace("_", " ")}
                              </span>
                            </div>
                            <p className="font-medium text-gray-800 mb-1">
                              {suggestion.start_formatted}
                            </p>
                            <p className="text-sm text-gray-600">
                              {suggestion.description}
                            </p>
                          </div>
                          <button
                            className="ml-3 px-3 py-1 text-sm border border-orange-300 text-orange-700 hover:bg-orange-100 rounded"
                            onClick={(e) => {
                              e.stopPropagation();
                              handleOptionSelect(suggestion.option);
                            }}
                          >
                            Select
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>

                  <div className="flex gap-2 pt-2">
                    <button
                      className="px-3 py-1 text-sm border border-orange-300 text-orange-700 hover:bg-orange-100 rounded"
                      onClick={handleDifferentTimes}
                    >
                      Different Times
                    </button>
                    <button
                      className="px-3 py-1 text-sm border border-gray-300 text-gray-700 hover:bg-gray-100 rounded"
                      onClick={handleCancel}
                    >
                      Cancel
                    </button>
                  </div>

                  <div className="text-xs text-orange-600 bg-orange-50 p-2 rounded border border-orange-200">
                    üí° <strong>Tip:</strong> You can also speak your choice by
                    saying "Option 1", "Option 2", "Option 3", or "Different
                    times"
                  </div>
                </div>
              </div>
            )}

            {/* Activity Log */}
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h3 className="text-lg font-semibold text-gray-800 mb-4">
                Activity Log
              </h3>
              <div className="h-32 p-4 bg-gray-50 rounded-lg border border-gray-200 overflow-y-auto">
                <div className="space-y-1">
                  {messages.length === 0 ? (
                    <p className="text-gray-400 italic text-sm">
                      Activity messages will appear here...
                    </p>
                  ) : (
                    messages.map((msg, idx) => (
                      <div
                        key={idx}
                        className="text-sm text-gray-600 font-mono"
                      >
                        {msg}
                      </div>
                    ))
                  )}
                </div>
              </div>
            </div>

            {/* Test Controls */}
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h3 className="text-lg font-semibold text-gray-800 mb-4">
                Test Controls
              </h3>
              <div className="flex gap-2">
                <button
                  className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                  onClick={() => {
                    setIsAwaitingConflictResolution(true);
                    setConflictData(mockConflictData);
                    addMessage("üîÑ Simulated conflict detection");
                  }}
                >
                  Simulate Conflict
                </button>
                <button
                  className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700"
                  onClick={() => setMessages([])}
                >
                  Clear Log
                </button>
              </div>
            </div>

            {!isAwaitingConflictResolution && (
              <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                <p className="text-green-800">
                  ‚úÖ No active conflicts. Use "Simulate Conflict" to test the
                  UI.
                </p>
              </div>
            )}
          </div>
        );
      }

      ReactDOM.render(
        <ConflictResolutionTest />,
        document.getElementById("root")
      );
    </script>
  </body>
</html>
